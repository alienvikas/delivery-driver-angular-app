<div class="app-sidenav-content">
    <mat-accordion class="example-headers-align" multi>
        <form #personDetailForm="ngForm" [formGroup]="personForm" (ngSubmit)="onPersonDetailSubmit(personForm)">
            <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)">

                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{'Labels.personaldetails'|translate}}
                    </mat-panel-title>
                    <mat-panel-description>
                        Information regarding personal details
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>{{'Labels.chooseintroducer'|translate}}</mat-label>
                            <mat-select formControlName="introducerId">
                                <mat-option *ngFor="let introducer of introducerOptions" [value]="introducer">
                                    {{introducer.name}}
                                </mat-option>
                            </mat-select>
                            <mat-error
                                *ngIf="personForm.hasError('required','introducerId') && personDetailForm.submitted">Select
                                introducer
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Select home base </mat-label>
                            <mat-select formControlName="ddHomeBaseId">
                                <mat-option *ngFor="let homebase of ddHomeBaseOptions" [value]="homebase">
                                    {{homebase.name}}
                                </mat-option>
                            </mat-select>
                            <mat-error
                                *ngIf="personForm.hasError('required','ddHomeBaseId') && personDetailForm.submitted">Select
                                home
                                base</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Known as</mat-label>
                            <input matInput (blur)="onBlur()" formControlName="knownAs">
                            <mat-hint>
                                <mat-icon
                                    matTooltip="What you would like to be Known As (Christian Name, + Surname or Family name)">help
                                    outline
                                    icon</mat-icon>
                            </mat-hint>
                            <mat-error
                                *ngIf="personForm.hasError('required','knownAs') && personDetailForm.submitted">KnownAs
                                required</mat-error>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Offical name</mat-label>
                            <input matInput (blur)="onBlur()" formControlName="officialName">
                            <mat-hint>
                                <mat-icon matTooltip="Full Name as on Your passport
                                    ">help
                                    outline
                                    icon</mat-icon>
                            </mat-hint>
                            <mat-error
                                *ngIf="personForm.hasError('required','officialName') && personDetailForm.submitted">Offical
                                name required</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>{{'Labels.mobile'|translate}}</mat-label>
                            <input matInput (blur)="onBlur()" formControlName="mobileNumber"
                                placeholder="+xxx xxxx xxxxxx">
                            <mat-hint>
                                <mat-icon matTooltip="it should be in the format +*** **** ******">help
                                    outline
                                    icon</mat-icon>
                            </mat-hint>
                            <mat-error *ngIf="f['mobileNumber'].hasError('required')">Mobile number required</mat-error>
                            <mat-error *ngIf="f['mobileNumber'].hasError('pattern')">Only numbers are
                                allowed</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Date of birth</mat-label>
                            <input matInput (blur)="onBlur()" [matDatepicker]="picker" formControlName="dateOfBirth"
                                placeholder="DD/MM/YYYY">
                            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>{{'Labels.choosenationality'|translate}}</mat-label>
                            <mat-select formControlName="nationalityId">
                                <mat-form-field appearance="fill" class="select-element">
                                    <input matInput #nationalitySearch placeholder="Search nationality"
                                        (input)="filterNationality(nationalitySearch.value)" />
                                    <button *ngIf="nationalitySearch.value" matSuffix mat-icon-button aria-label="Clear"
                                        (click)="nationalitySearch.value=''">
                                        <mat-icon>close</mat-icon>
                                    </button>
                                </mat-form-field>
                                <mat-option *ngFor="let nationality of nationalityOption;let i = index;"
                                    [value]="nationality.id">
                                    <mat-checkbox [checked]="selected === i" (change)="selected = i">
                                        <span class="fi fi-{{nationality.countryISO | lowercase}}">
                                        </span>
                                        {{nationality.countryName}}
                                    </mat-checkbox>
                                </mat-option>
                            </mat-select>
                            <mat-error *ngIf="f['nationalityId'].hasError('required')">Select nationality</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>{{'Labels.email'|translate}}</mat-label>
                            <input matInput (blur)="onBlur()" formControlName="emailAddress"
                                placeholder="example@abc.com">
                            <mat-error *ngIf="f['emailAddress'].hasError('required')">Mobile number required</mat-error>
                            <mat-error *ngIf="f['emailAddress'].hasError('email')">Invalid email</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Telegram Number / Username</mat-label>
                            <input matInput (blur)="onBlur()" formControlName="usernameOrTelegramNumber"
                                placeholder="+xx xxx-xxx-xxxx">
                            <mat-error *ngIf="f['usernameOrTelegramNumber'].hasError('pattern')">Only numbers are
                                allowed
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Street</mat-label>
                            <input matInput formControlName="street">
                            <mat-error *ngIf="f['street'].hasError('required')">Street required</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Area</mat-label>
                            <input matInput formControlName="area">
                            <mat-error *ngIf="f['area'].hasError('required')">Area required</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Town or City</mat-label>
                            <input matInput formControlName="towncity">
                            <mat-error *ngIf="f['towncity'].hasError('required')">Town or City required</mat-error>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <!-- <ng-multiselect-dropdown appearance="fill" [placeholder]="'custom placeholder'"
                            [settings]="dropdownSettings" [data]="countyOptions" formControlName="countyId">
                            <ng-template #optionsTemplate let-item let-option="option" let-id="id"
                                let-isSelected="isSelected">
                                <div style="padding: 1px 10px;">
                                    <span style="display: block; margin-left: 30px;"
                                        [ngStyle]="{ 'background': isSelected ? '#673ab7':''}">
                                        {{option}}
                                    </span>
                                </div>
                            </ng-template>
                        </ng-multiselect-dropdown> -->
                        <mat-form-field appearance="outline" class="select-element">
                            <mat-label>County</mat-label>
                            <mat-select formControlName="countyId" [multiple]="true">
                                <mat-form-field appearance="fill" class="select-element">
                                    <input matInput #countySearch placeholder="Search County"
                                        (input)="filterCounty(countySearch.value)" />
                                    <button *ngIf="countySearch.value" matSuffix mat-icon-button aria-label="Clear"
                                        (click)="countySearch.value=''">
                                        <mat-icon>close</mat-icon>
                                    </button>
                                </mat-form-field>
                                <mat-option *ngFor="let county of countyOptions; index as i" [value]="county.id">
                                    {{county.name}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        <!-- <mat-form-field appearance="fill">
                            <mat-label>County</mat-label>
                            <mat-select formControlName="countyId">
                                <mat-option *ngFor="let county of countyOptions" [value]="county.id">
                                    {{county.name}}
                                </mat-option>
                            </mat-select>
                            <mat-select formControlName="countyId" [multiple]="true" #multiSelect>
                                <mat-option>
                                    <ngx-mat-select-search formControlName="countyId"
                                        noEntriesFoundLabel="'no matching found'" [showToggleAllCheckbox]="true"
                                        toggleAllCheckboxTooltipMessage="Select / Unselect All">
                                        <mat-icon ngxMatSelectSearchClear>delete</mat-icon>
                                    </ngx-mat-select-search>
                                </mat-option>

                                <mat-option *ngFor="let county of countyOptions" [value]="county.id">
                                    {{county.name}}
                                </mat-option>
                            </mat-select>
                            <mat-error *ngIf="f['countyId'].hasError('required')">Country required</mat-error>
                        </mat-form-field> -->

                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="outline">
                            <mat-label>Post Code</mat-label>
                            <input matInput (blur)="onBlur()" formControlName="postcode">
                            <mat-error *ngIf="f['postcode'].hasError('required')">Post code
                                required</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <!-- <mat-button-toggle-group appearance="legacy">
                            <mat-button-toggle>
                                <input type="file" class="file-input" #fileUpload>
                            </mat-button-toggle>
                            <mat-button-toggle (click)="takeSelfie()">Take Selfie</mat-button-toggle>
                        </mat-button-toggle-group>
                        <webcam *ngIf="showWebCam" [height]="400" [width]="1000"></webcam> -->
                    </div>
                </div>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <label>Selfie / Photo</label>
                        <input type="file" class="file-input" #fileUpload>
                        <!-- <mat-button-toggle-group #photoUploadGroup appearance="legacy">
                            <mat-button-toggle (click)="takeSelfie()">
                                Take Selfie <mat-icon>camera_alt</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle>
                                <button type="button" class="btn-file-upload" (click)="fileInput.click()">
                                    <span>Photo Upload</span>
                                    <mat-icon style="vertical-align: middle;">attach_file</mat-icon>
                                    <input #fileInput type="file" style="display:none;" />
                                </button>
                                <webcam *ngIf="showWebCam" [height]="400" [width]="1000"></webcam>
                            </mat-button-toggle>
                        </mat-button-toggle-group> -->
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4"></div>
                    <div class="col-xl-4 col-md-4 col-sm-4"></div>
                </div>

                <mat-action-row>
                    <button mat-button type="submit" color="primary">Next</button>
                </mat-action-row>

            </mat-expansion-panel>


            <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Identification
                    </mat-panel-title>
                    <mat-panel-description>
                        Information regarding identification proof
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <label>Birth Certificate</label>
                        <input type="file" class="file-input" #fileUpload>
                    </div>
                </div>

                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">Previous</button>
                    <button mat-button color="primary">Next</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Vehicle Details
                    </mat-panel-title>
                    <mat-panel-description>
                        Information regarding the vechicle
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <div class="row">
                    <div class="col-4 col-sm-4 col-md-4">
                        <mat-label>Vehicle Type</mat-label>
                        <mat-radio-group aria-label="Select an option">
                            <mat-radio-button value="Van">Van</mat-radio-button>
                            <mat-radio-button value="Car">Car</mat-radio-button>
                            <mat-radio-button value="Motor Cycl">Motor Cycle</mat-radio-button>
                            <mat-radio-button value="Bicycle">Bicycle</mat-radio-button>
                        </mat-radio-group>
                    </div>
                    <div class="col-4 col-sm-4 col-md-4">
                        <mat-form-field appearance="fill">
                            <mat-label>Vehicle Manufacturer</mat-label>
                            <mat-select placeholder="Vehicle Manufacturer">
                                <mat-option>
                                    <option value="0">Vehicle 1</option>
                                    <option value="0">Vehicle 2</option>
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="col-4 col-sm-4 col-md-4">
                        <mat-form-field appearance="fill">
                            <mat-label>Vehicle Model</mat-label>
                            <mat-select placeholder="Vehicle Model">
                                <mat-option>
                                    <option value="0">Vehicle Model 1</option>
                                    <option value="0">Vehicle Model 2</option>
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>

                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">Previous</button>
                    <button mat-button color="primary">End</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="step === 3" (opened)="setStep(3)">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Working Area
                    </mat-panel-title>
                    <mat-panel-description>
                        Information regarding the working area
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <div class="row">
                    <div class="col-xl-4 col-md-4 col-sm-4">
                        <mat-form-field appearance="fill">
                            <mat-label>Working country</mat-label>
                            <mat-select [formControl]="workingCountrys" multiple>
                                <mat-select-trigger>
                                    {{workingCountrys.value?.[0] || ''}}
                                    <span *ngIf="(workingCountrys.value?.length || 0) > 1"
                                        class="example-additional-selection">
                                        (+{{(workingCountrys.value?.length || 0) - 1}} {{workingCountrys.value?.length
                                        === 2 ? 'other'
                                        : 'others'}})
                                    </span>
                                </mat-select-trigger>
                                <mat-option *ngFor="let country of workingCountryList"
                                    [value]="country">{{country}}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="f['postcode']"></mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </mat-expansion-panel>
        </form>
    </mat-accordion>
</div>